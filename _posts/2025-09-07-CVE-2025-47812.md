---
layout: post
title: "CVE-2025-47812, attack chain giúp stealth siêu cấp vũ trụ"
categories: Pentest
tags: [redteam, devops, OS, PE, system, blueteam, immediately]
---

# Mờ đầu
Khá lâu rồi mình mới lên một bài blog kĩ thuật, đây là quá trình tự mình nghiên cứu đồng thời học hỏi và tiếp thu kiến thức của đàn anh trong khoảng thời gian vừa rồi. Bài viết sẽ là cách chain CVE-2025-47812 với kĩ thuật Pre OS loading giúp cho attacker sau khi khai thác thành công sẽ stealth trên máy nạn nhân. Mặc dù vẫn còn nhiều hạn chế trong việc khiến người dùng (ở đây là server) trigger file độc hại nhưng vẫn sẽ là một cách để mọi người mở rộng kiến thức
![malware here](/images/cve-2025-47812/malware_here.jpg)

# Thân bài
### Tổng quan
Wing FTP Server là một phần mềm máy chủ chạy trên nhiều nền tảng hệ điều hành khác nhau: Linux, Window, MacOS được phát triển để truyền file với nhiều protocols như: FTP, SSH, SFTP, HTTP, HTTPS,... Phần mềm này được sử dụng rộng rãi trong các doanh nghiệp, trong mạng nội bộ lẫn bên ngoài Internet.

![banner](/images/cve-2025-47812/banner_wingftp.jpg)

Ngày 30/06/2025, [bài viết](https://www.rcesecurity.com/2025/06/what-the-null-wing-ftp-server-rce-cve-2025-47812) về lỗ hổng này được công bố và chỉ 1 ngày sau đó đã ghi nhận cuộc tấn bởi [huntress](https://www.huntress.com/blog/wing-ftp-server-remote-code-execution-cve-2025-47812-exploited-in-wild). Thông tin về lỗi được mô tả như sau:

![banner](/images/cve-2025-47812/sumary.jpg)
**Các điểm cần lưu ý**
+ CVE này có điểm CVSS là 10.0: Đây là điểm rất cao vì bề mặt tấn công và độ phức tạp rất dễ để khai thác và không yêu cầu bất kì tương tác nào của người dùng
+ CVE xảy ra trên máy chủ Wing FTP Server trước bản 7.4.4: Từ bản 7.4.3 trở xuống đã có thể bị tấn công
+ Lỗ hổng xảy ra trong quá trình xử lý `nullbyte` tại giao diện đăng nhập của admin và user cho phép RCE
+ Lỗ hổng còn cho phép leo thang đặc quyền (Administrator với Windows, root với Linux, mình chưa test trên MacOS) do chạy mặc định với quyền cao.

### Phân tích kĩ thuật

**1. Dựng môi trường phân tích**

**2. Phân tích lỗ hổng**

**3. Diff patch và đánh giá patching**

**4. Scan Wing FTP Server public và đánh giá bảo mật**

### Tổng quan về Pre OS Bootloading